<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Alex Edwards">
  <meta name="author" content="Zane Billings">
  <title>SISMID R for ID Materials (2025) – Module 6: S3 and R Formulas</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Module 6: S3 and R Formulas</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://sph.emory.edu/profile/faculty/alex-edwards">Alex Edwards</a> 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://wzbillings.com/">Zane Billings</a> 
</div>
</div>
</div>

</section>
<section id="learning-goals" class="slide level2">
<h2>Learning goals</h2>
<ol type="1">
<li>Explain what S3 is and give an example of an S3 method</li>
<li>Understand the R help pages for S3 methods</li>
<li>Use vectorization to replace unnecessary loops</li>
<li>Understand when and how to use the R formula syntax</li>
<li>Write basic linear models with R formulas</li>
</ol>
</section>
<section>
<section id="part-1-s3-stands-for-310-scariness" class="title-slide slide level1 center">
<h1>Part 1: S3 stands for 3/10 Scariness</h1>

</section>
<section id="objects-and-classes-and-methods" class="slide level2 incremental">
<h2>Objects and classes and methods</h2>
<ul>
<li>We’ve talked about imperative programming and functional programming. Now we’ll talk about <strong>object-oriented programming.</strong></li>
<li>S3 is a “functional OOP” system, which is different from OOP you might have dealt with in Python or C++.</li>
<li>The main propery of S3 is <strong>polymorphism</strong>: one <strong>generic function</strong> can act differently on different <strong>classes</strong> of objects, but symbolically represents the same thing and has a consistent interface.</li>
</ul>
</section>
<section id="an-s3-example" class="slide level2 scrollable">
<h2>An S3 example</h2>
<ul>
<li><code>summary()</code> is an example of an S3 <strong>generic</strong>. And the documentation tells us this.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>?summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object Summaries

Description:

     'summary' is a generic function used to produce result summaries
     of the results of various model fitting functions.  The function
     invokes particular 'methods' which depend on the 'class' of the
     first argument.

Usage:

     summary(object, ...)
     
     ## Default S3 method:
     summary(object, ..., digits, quantile.type = 7)
     ## S3 method for class 'data.frame'
     summary(object, maxsum = 7,
            digits = max(3, getOption("digits")-3), ...)
     
     ## S3 method for class 'factor'
     summary(object, maxsum = 100, ...)
     
     ## S3 method for class 'matrix'
     summary(object, ...)
     
     ## S3 method for class 'summaryDefault'
     format(x, digits = max(3L, getOption("digits") - 3L), zdigits = 4L, ...)
      ## S3 method for class 'summaryDefault'
     print(x, digits = max(3L, getOption("digits") - 3L), zdigits = 4L, ...)
     
Arguments:

  object: an object for which a summary is desired.

       x: a result of the _default_ method of 'summary()'.

  maxsum: integer, indicating how many levels should be shown for
          'factor's.

  digits: integer (or 'NULL', see 'Details'), used for number
          formatting with 'signif()' (for 'summary.default') or
          'format()' (for 'summary.data.frame').  In 'summary.default',
          if not specified (i.e., 'missing(.)'), 'signif()' will _not_
          be called anymore (since R &gt;= 3.4.0, where the default has
          been changed to only round in the 'print' and 'format'
          methods).

 zdigits: integer, typically positive to be used in the internal
          'zapsmall(*, digits = digits + zdigits)' call.

quantile.type: integer code used in 'quantile(*, type=quantile.type)'
          for the default method.

     ...: additional arguments affecting the summary produced.

Details:

     For 'factor's, the frequency of the first 'maxsum - 1' most
     frequent levels is shown, and the less frequent levels are
     summarized in '"(Others)"' (resulting in at most 'maxsum'
     frequencies).

     The 'digits' argument may be 'NULL' for some methods specifying to
     use the default value, e.g., for the '"summaryDefault"' 'format()'
     method.

     The functions 'summary.lm' and 'summary.glm' are examples of
     particular methods which summarize the results produced by 'lm'
     and 'glm'.

Value:

     The form of the value returned by 'summary' depends on the class
     of its argument.  See the documentation of the particular methods
     for details of what is produced by that method.

     The default method returns an object of class 'c("summaryDefault",
     "table")' which has specialized 'format' and 'print' methods.  The
     'factor' method returns an integer vector.

     The matrix and data frame methods return a matrix of class
     '"table"', obtained by applying 'summary' to each column and
     collating the results.

References:

     Chambers, J. M. and Hastie, T. J. (1992) _Statistical Models in
     S_.  Wadsworth &amp; Brooks/Cole.

See Also:

     'anova', 'summary.glm', 'summary.lm'.

Examples:

     summary(attenu, digits = 4) #-&gt; summary.data.frame(...), default precision
     summary(attenu $ station, maxsum = 20) #-&gt; summary.factor(...)
     
     lst &lt;- unclass(attenu$station) &gt; 20 # logical with NAs
     ## summary.default() for logicals -- different from *.factor:
     summary(lst)
     summary(as.factor(lst))
     
     ## show the effect of zdigits for skewed data
     set.seed(17); x &lt;- rlnorm(100, sdlog=2)
     dput(sx &lt;- summary(x))
     sx # exponential format for this data
     print(sx, zdigits = 3) # fixed point: "more readable"</code></pre>
</div>
</div>
</section>
<section id="polymorphism-of-summary" class="slide level2 scrollable">
<h2>Polymorphism of summary</h2>
<ul>
<li>When we call <code>summary(an_object)</code> it determines what it should do based on the class of <code>an_object</code>.</li>
<li>Each of the following summaries shows us different statistics.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">class</span>(an_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">summary</span>(an_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bwt ~ age, data = birthwt)

Residuals:
     Min       1Q   Median       3Q      Max 
-2294.78  -517.63    10.51   530.80  1774.92 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2655.74     238.86   11.12   &lt;2e-16 ***
age            12.43      10.02    1.24    0.216    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 728.2 on 187 degrees of freedom
Multiple R-squared:  0.008157,  Adjusted R-squared:  0.002853 
F-statistic: 1.538 on 1 and 187 DF,  p-value: 0.2165</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">class</span>(a_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "glm" "lm" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">summary</span>(a_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = low ~ age, family = "binomial", data = birthwt)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  0.38458    0.73212   0.525    0.599
age         -0.05115    0.03151  -1.623    0.105

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 234.67  on 188  degrees of freedom
Residual deviance: 231.91  on 187  degrees of freedom
AIC: 235.91

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">class</span>(a_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "glmerMod"
attr(,"package")
[1] "lme4"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="fu">summary</span>(a_glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: low ~ age + (1 | id)
   Data: birthwt

      AIC       BIC    logLik -2*log(L)  df.resid 
    237.9     247.6    -116.0     231.9       186 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.8451 -0.7066 -0.5908  1.3042  1.9639 

Random effects:
 Groups Name        Variance Std.Dev.
 id     (Intercept) 0.009912 0.09956 
Number of obs: 189, groups:  id, 189

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  0.38540    0.73534   0.524    0.600
age         -0.05127    0.03234  -1.585    0.113

Correlation of Fixed Effects:
    (Intr)
age -0.966</code></pre>
</div>
</div>
</div>
</section>
<section id="some-oop-definitions" class="slide level2 smaller">
<h2>Some OOP definitions</h2>
<ul>
<li>A <strong>class</strong> is a category of object. Objects of the same class have the same <strong>fields</strong> or attributes.</li>
<li>A <strong>generic</strong> is a function that has different behavior for multiple classes of inputs.</li>
<li>The <strong>methods</strong> for a function are the function implementations for specific classes.</li>
<li><strong>Method dispatch</strong> is the process where you call a generic function, the generic function checks the class of the input, and the generic function calls the method for that class.</li>
<li>A <strong>default method</strong> is dispatched by a generic function when there is no specific method for the class of the input. Not every generic has a default method.</li>
</ul>
</section>
<section id="s3-classes" class="slide level2 incremental">
<h2>S3 classes</h2>
<ul>
<li>Everything that exists in R is an object and has a <strong>type</strong>.</li>
<li>But not everything is an S3 object, and only S3 objects have a <strong>class</strong>.</li>
<li>This is confusing, because the function <code>class()</code> will tell you something for every object, no matter what. <strong>If an object does not have a class, <code>class()</code> will return the type.</strong></li>
<li>To check if an object <em>has</em> an S3 class, you have to check the extremely confusing <code>attr(an_object, "class")</code> instead.</li>
</ul>
</section>
<section id="s3-classes-and-types" class="slide level2">
<h2>S3 classes (and types)</h2>
<ul>
<li>These objects have types but not classes: <code>NULL</code>, vectors, lists, functions, and some other special ones that you won’t use.</li>
<li>You can pretty much pretend that types are classes.</li>
</ul>
</section>
<section id="s3-classes-and-types-1" class="slide level2">
<h2>S3 classes (and types)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>an_object <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb15-2"><a></a><span class="fu">typeof</span>(an_object)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">class</span>(an_object)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">attr</span>(an_object, <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="s3-classes-and-types-2" class="slide level2">
<h2>S3 classes (and types)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="fu">typeof</span>(an_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="fu">class</span>(an_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a><span class="fu">attr</span>(an_lm, <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm"</code></pre>
</div>
</div>
</section>
<section id="s3-classes-and-types-3" class="slide level2 scrollable">
<h2>S3 classes (and types)</h2>
<ul>
<li>If an object has an S3 class, then it is a list.</li>
<li>The only things that aren’t lists are the other special objects with types.</li>
<li>Complicated S3 classes are just lists where the elements have specific names.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a><span class="fu">str</span>(an_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 12
 $ coefficients : Named num [1:2] 2655.7 12.4
  ..- attr(*, "names")= chr [1:2] "(Intercept)" "age"
 $ residuals    : Named num [1:189] -369 -515 -347 -323 -279 ...
  ..- attr(*, "names")= chr [1:189] "85" "86" "87" "88" ...
 $ effects      : Named num [1:189] -40481 -903 -340 -309 -284 ...
  ..- attr(*, "names")= chr [1:189] "(Intercept)" "age" "" "" ...
 $ rank         : int 2
 $ fitted.values: Named num [1:189] 2892 3066 2904 2917 2879 ...
  ..- attr(*, "names")= chr [1:189] "85" "86" "87" "88" ...
 $ assign       : int [1:2] 0 1
 $ qr           :List of 5
  ..$ qr   : num [1:189, 1:2] -13.7477 0.0727 0.0727 0.0727 0.0727 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:189] "85" "86" "87" "88" ...
  .. .. ..$ : chr [1:2] "(Intercept)" "age"
  .. ..- attr(*, "assign")= int [1:2] 0 1
  ..$ qraux: num [1:2] 1.07 1.14
  ..$ pivot: int [1:2] 1 2
  ..$ tol  : num 1e-07
  ..$ rank : int 2
  ..- attr(*, "class")= chr "qr"
 $ df.residual  : int 187
 $ xlevels      : Named list()
 $ call         : language lm(formula = bwt ~ age, data = birthwt)
 $ terms        :Classes 'terms', 'formula'  language bwt ~ age
  .. ..- attr(*, "variables")= language list(bwt, age)
  .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. ..$ : chr [1:2] "bwt" "age"
  .. .. .. ..$ : chr "age"
  .. ..- attr(*, "term.labels")= chr "age"
  .. ..- attr(*, "order")= int 1
  .. ..- attr(*, "intercept")= int 1
  .. ..- attr(*, "response")= int 1
  .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. ..- attr(*, "predvars")= language list(bwt, age)
  .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
  .. .. ..- attr(*, "names")= chr [1:2] "bwt" "age"
 $ model        :'data.frame':  189 obs. of  2 variables:
  ..$ bwt: int [1:189] 2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...
  ..$ age: int [1:189] 19 33 20 21 18 21 22 17 29 26 ...
  ..- attr(*, "terms")=Classes 'terms', 'formula'  language bwt ~ age
  .. .. ..- attr(*, "variables")= language list(bwt, age)
  .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:2] "bwt" "age"
  .. .. .. .. ..$ : chr "age"
  .. .. ..- attr(*, "term.labels")= chr "age"
  .. .. ..- attr(*, "order")= int 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(bwt, age)
  .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
  .. .. .. ..- attr(*, "names")= chr [1:2] "bwt" "age"
 - attr(*, "class")= chr "lm"</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>?lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting Linear Models

Description:

     'lm' is used to fit linear models, including multivariate ones.
     It can be used to carry out regression, single stratum analysis of
     variance and analysis of covariance (although 'aov' may provide a
     more convenient interface for these).

Usage:

     lm(formula, data, subset, weights, na.action,
        method = "qr", model = TRUE, x = FALSE, y = FALSE, qr = TRUE,
        singular.ok = TRUE, contrasts = NULL, offset, ...)
     
     ## S3 method for class 'lm'
     print(x, digits = max(3L, getOption("digits") - 3L), ...)
     
Arguments:

 formula: an object of class '"formula"' (or one that can be coerced to
          that class): a symbolic description of the model to be
          fitted.  The details of model specification are given under
          'Details'.

    data: an optional data frame, list or environment (or object
          coercible by 'as.data.frame' to a data frame) containing the
          variables in the model.  If not found in 'data', the
          variables are taken from 'environment(formula)', typically
          the environment from which 'lm' is called.

  subset: an optional vector specifying a subset of observations to be
          used in the fitting process.  (See additional details about
          how this argument interacts with data-dependent bases in the
          'Details' section of the 'model.frame' documentation.)

 weights: an optional vector of weights to be used in the fitting
          process.  Should be 'NULL' or a numeric vector.  If non-NULL,
          weighted least squares is used with weights 'weights' (that
          is, minimizing 'sum(w*e^2)'); otherwise ordinary least
          squares is used.  See also 'Details',

na.action: a function which indicates what should happen when the data
          contain 'NA's.  The default is set by the 'na.action' setting
          of 'options', and is 'na.fail' if that is unset.  The
          'factory-fresh' default is 'na.omit'.  Another possible value
          is 'NULL', no action.  Value 'na.exclude' can be useful.

  method: the method to be used; for fitting, currently only 'method =
          "qr"' is supported; 'method = "model.frame"' returns the
          model frame (the same as with 'model = TRUE', see below).

model, x, y, qr: logicals.  If 'TRUE' the corresponding components of
          the fit (the model frame, the model matrix, the response, the
          QR decomposition) are returned.

singular.ok: logical. If 'FALSE' (the default in S but not in R) a
          singular fit is an error.

contrasts: an optional list. See the 'contrasts.arg' of
          'model.matrix.default'.

  offset: this can be used to specify an _a priori_ known component to
          be included in the linear predictor during fitting.  This
          should be 'NULL' or a numeric vector or matrix of extents
          matching those of the response.  One or more 'offset' terms
          can be included in the formula instead or as well, and if
          more than one are specified their sum is used.  See
          'model.offset'.

     ...: For 'lm()': additional arguments to be passed to the low
          level regression fitting functions (see below).

  digits: the number of _significant_ digits to be passed to
          'format(coef(x), .)' when 'print()'ing.

Details:

     Models for 'lm' are specified symbolically.  A typical model has
     the form 'response ~ terms' where 'response' is the (numeric)
     response vector and 'terms' is a series of terms which specifies a
     linear predictor for 'response'.  A terms specification of the
     form 'first + second' indicates all the terms in 'first' together
     with all the terms in 'second' with duplicates removed.  A
     specification of the form 'first:second' indicates the set of
     terms obtained by taking the interactions of all terms in 'first'
     with all terms in 'second'.  The specification 'first*second'
     indicates the _cross_ of 'first' and 'second'.  This is the same
     as 'first + second + first:second'.

     If the formula includes an 'offset', this is evaluated and
     subtracted from the response.

     If 'response' is a matrix a linear model is fitted separately by
     least-squares to each column of the matrix and the result inherits
     from '"mlm"' ("multivariate linear model").

     See 'model.matrix' for some further details.  The terms in the
     formula will be re-ordered so that main effects come first,
     followed by the interactions, all second-order, all third-order
     and so on: to avoid this pass a 'terms' object as the formula (see
     'aov' and 'demo(glm.vr)' for an example).

     A formula has an implied intercept term.  To remove this use
     either 'y ~ x - 1' or 'y ~ 0 + x'.  See 'formula' for more details
     of allowed formulae.

     Non-'NULL' 'weights' can be used to indicate that different
     observations have different variances (with the values in
     'weights' being inversely proportional to the variances); or
     equivalently, when the elements of 'weights' are positive integers
     w_i, that each response y_i is the mean of w_i unit-weight
     observations (including the case that there are w_i observations
     equal to y_i and the data have been summarized). However, in the
     latter case, notice that within-group variation is not used.
     Therefore, the sigma estimate and residual degrees of freedom may
     be suboptimal; in the case of replication weights, even wrong.
     Hence, standard errors and analysis of variance tables should be
     treated with care.

     'lm' calls the lower level functions 'lm.fit', etc, see below, for
     the actual numerical computations.  For programming only, you may
     consider doing likewise.

     All of 'weights', 'subset' and 'offset' are evaluated in the same
     way as variables in 'formula', that is first in 'data' and then in
     the environment of 'formula'.

Value:

     'lm' returns an object of 'class' '"lm"' or for multivariate
     ('multiple') responses of class 'c("mlm", "lm")'.

     The functions 'summary' and 'anova' are used to obtain and print a
     summary and analysis of variance table of the results.  The
     generic accessor functions 'coefficients', 'effects',
     'fitted.values' and 'residuals' extract various useful features of
     the value returned by 'lm'.

     An object of class '"lm"' is a list containing at least the
     following components:

coefficients: a named vector of coefficients

residuals: the residuals, that is response minus fitted values.

fitted.values: the fitted mean values.

    rank: the numeric rank of the fitted linear model.

 weights: (only for weighted fits) the specified weights.

df.residual: the residual degrees of freedom.

    call: the matched call.

   terms: the 'terms' object used.

contrasts: (only where relevant) the contrasts used.

 xlevels: (only where relevant) a record of the levels of the factors
          used in fitting.

  offset: the offset used (missing if none were used).

       y: if requested, the response used.

       x: if requested, the model matrix used.

   model: if requested (the default), the model frame used.

na.action: (where relevant) information returned by 'model.frame' on
          the special handling of 'NA's.

     In addition, non-null fits will have components 'assign',
     'effects' and (unless not requested) 'qr' relating to the linear
     fit, for use by extractor functions such as 'summary' and
     'effects'.

Using time series:

     Considerable care is needed when using 'lm' with time series.

     Unless 'na.action = NULL', the time series attributes are stripped
     from the variables before the regression is done.  (This is
     necessary as omitting 'NA's would invalidate the time series
     attributes, and if 'NA's are omitted in the middle of the series
     the result would no longer be a regular time series.)

     Even if the time series attributes are retained, they are not used
     to line up series, so that the time shift of a lagged or
     differenced regressor would be ignored.  It is good practice to
     prepare a 'data' argument by 'ts.intersect(..., dframe = TRUE)',
     then apply a suitable 'na.action' to that data frame and call 'lm'
     with 'na.action = NULL' so that residuals and fitted values are
     time series.

Author(s):

     The design was inspired by the S function of the same name
     described in Chambers (1992).  The implementation of model formula
     by Ross Ihaka was based on Wilkinson &amp; Rogers (1973).

References:

     Chambers, J. M. (1992) _Linear models._ Chapter 4 of _Statistical
     Models in S_ eds J. M. Chambers and T. J. Hastie, Wadsworth &amp;
     Brooks/Cole.

     Wilkinson, G. N. and Rogers, C. E. (1973).  Symbolic descriptions
     of factorial models for analysis of variance.  _Applied
     Statistics_, *22*, 392-399.  doi:10.2307/2346786
     &lt;https://doi.org/10.2307/2346786&gt;.

See Also:

     'summary.lm' for more detailed summaries and 'anova.lm' for the
     ANOVA table; 'aov' for a different interface.

     The generic functions 'coef', 'effects', 'residuals', 'fitted',
     'vcov'.

     'predict.lm' (via 'predict') for prediction, including confidence
     and prediction intervals; 'confint' for confidence intervals of
     _parameters_.

     'lm.influence' for regression diagnostics, and 'glm' for
     *generalized* linear models.

     The underlying low level functions, 'lm.fit' for plain, and
     'lm.wfit' for weighted regression fitting.

     More 'lm()' examples are available e.g., in 'anscombe',
     'attitude', 'freeny', 'LifeCycleSavings', 'longley', 'stackloss',
     'swiss'.

     'biglm' in package 'biglm' for an alternative way to fit linear
     models to large datasets (especially those with many cases).

Examples:

     require(graphics)
     
     ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
     ## Page 9: Plant Weight Data.
     ctl &lt;- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
     trt &lt;- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
     group &lt;- gl(2, 10, 20, labels = c("Ctl","Trt"))
     weight &lt;- c(ctl, trt)
     lm.D9 &lt;- lm(weight ~ group)
     lm.D90 &lt;- lm(weight ~ group - 1) # omitting intercept
     
     anova(lm.D9)
     summary(lm.D90)
     
     opar &lt;- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
     plot(lm.D9, las = 1)      # Residuals, Fitted, ...
     par(opar)
     
     ### less simple examples in "See Also" above</code></pre>
</div>
</div>
</div>
</section>
<section id="s3-help-pages" class="slide level2">
<h2>S3 help pages</h2>
<ul>
<li>Now you know enough to understand the help pages for S3 objects.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a>?summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object Summaries

Description:

     'summary' is a generic function used to produce result summaries
     of the results of various model fitting functions.  The function
     invokes particular 'methods' which depend on the 'class' of the
     first argument.

Usage:

     summary(object, ...)
     
     ## Default S3 method:
     summary(object, ..., digits, quantile.type = 7)
     ## S3 method for class 'data.frame'
     summary(object, maxsum = 7,
            digits = max(3, getOption("digits")-3), ...)
     
     ## S3 method for class 'factor'
     summary(object, maxsum = 100, ...)
     
     ## S3 method for class 'matrix'
     summary(object, ...)
     
     ## S3 method for class 'summaryDefault'
     format(x, digits = max(3L, getOption("digits") - 3L), zdigits = 4L, ...)
      ## S3 method for class 'summaryDefault'
     print(x, digits = max(3L, getOption("digits") - 3L), zdigits = 4L, ...)
     
Arguments:

  object: an object for which a summary is desired.

       x: a result of the _default_ method of 'summary()'.

  maxsum: integer, indicating how many levels should be shown for
          'factor's.

  digits: integer (or 'NULL', see 'Details'), used for number
          formatting with 'signif()' (for 'summary.default') or
          'format()' (for 'summary.data.frame').  In 'summary.default',
          if not specified (i.e., 'missing(.)'), 'signif()' will _not_
          be called anymore (since R &gt;= 3.4.0, where the default has
          been changed to only round in the 'print' and 'format'
          methods).

 zdigits: integer, typically positive to be used in the internal
          'zapsmall(*, digits = digits + zdigits)' call.

quantile.type: integer code used in 'quantile(*, type=quantile.type)'
          for the default method.

     ...: additional arguments affecting the summary produced.

Details:

     For 'factor's, the frequency of the first 'maxsum - 1' most
     frequent levels is shown, and the less frequent levels are
     summarized in '"(Others)"' (resulting in at most 'maxsum'
     frequencies).

     The 'digits' argument may be 'NULL' for some methods specifying to
     use the default value, e.g., for the '"summaryDefault"' 'format()'
     method.

     The functions 'summary.lm' and 'summary.glm' are examples of
     particular methods which summarize the results produced by 'lm'
     and 'glm'.

Value:

     The form of the value returned by 'summary' depends on the class
     of its argument.  See the documentation of the particular methods
     for details of what is produced by that method.

     The default method returns an object of class 'c("summaryDefault",
     "table")' which has specialized 'format' and 'print' methods.  The
     'factor' method returns an integer vector.

     The matrix and data frame methods return a matrix of class
     '"table"', obtained by applying 'summary' to each column and
     collating the results.

References:

     Chambers, J. M. and Hastie, T. J. (1992) _Statistical Models in
     S_.  Wadsworth &amp; Brooks/Cole.

See Also:

     'anova', 'summary.glm', 'summary.lm'.

Examples:

     summary(attenu, digits = 4) #-&gt; summary.data.frame(...), default precision
     summary(attenu $ station, maxsum = 20) #-&gt; summary.factor(...)
     
     lst &lt;- unclass(attenu$station) &gt; 20 # logical with NAs
     ## summary.default() for logicals -- different from *.factor:
     summary(lst)
     summary(as.factor(lst))
     
     ## show the effect of zdigits for skewed data
     set.seed(17); x &lt;- rlnorm(100, sdlog=2)
     dput(sx &lt;- summary(x))
     sx # exponential format for this data
     print(sx, zdigits = 3) # fixed point: "more readable"</code></pre>
</div>
</div>
</section>
<section id="finding-classes-and-finding-methods" class="slide level2">
<h2>Finding classes and finding methods</h2>
<ul>
<li>Use the <code>methods()</code> function to find all methods that are available for a specific generic function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a><span class="fu">methods</span>(summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] summary,ANY-method                  summary,diagonalMatrix-method      
 [3] summary,sparseMatrix-method         summary.allFit*                    
 [5] summary.aov                         summary.aovlist*                   
 [7] summary.aspell*                     summary.check_packages_in_dir*     
 [9] summary.connection                  summary.corAR1*                    
[11] summary.corARMA*                    summary.corCAR1*                   
[13] summary.corCompSymm*                summary.corExp*                    
[15] summary.corGaus*                    summary.corIdent*                  
[17] summary.corLin*                     summary.corNatural*                
[19] summary.corRatio*                   summary.corSpher*                  
[21] summary.corStruct*                  summary.corSymm*                   
[23] summary.data.frame                  summary.Date                       
[25] summary.default                     summary.difftime                   
[27] summary.ecdf*                       summary.factor                     
[29] summary.glm                         summary.gls*                       
[31] summary.infl*                       summary.lm                         
[33] summary.lme*                        summary.lmList*                    
[35] summary.lmList4*                    summary.loess*                     
[37] summary.loglm*                      summary.manova                     
[39] summary.matrix                      summary.merMod*                    
[41] summary.mlm*                        summary.modelStruct*               
[43] summary.negbin*                     summary.nls*                       
[45] summary.nlsList*                    summary.packageStatus*             
[47] summary.pdBlocked*                  summary.pdCompSymm*                
[49] summary.pdDiag*                     summary.pdIdent*                   
[51] summary.pdLogChol*                  summary.pdMat*                     
[53] summary.pdNatural*                  summary.pdSymm*                    
[55] summary.polr*                       summary.POSIXct                    
[57] summary.POSIXlt                     summary.ppr*                       
[59] summary.prcomp*                     summary.prcomplist*                
[61] summary.princomp*                   summary.proc_time                  
[63] summary.reStruct*                   summary.rlang:::list_of_conditions*
[65] summary.rlang_error*                summary.rlang_message*             
[67] summary.rlang_trace*                summary.rlang_warning*             
[69] summary.rlm*                        summary.shingle*                   
[71] summary.srcfile                     summary.srcref                     
[73] summary.stepfun                     summary.stl*                       
[75] summary.summary.merMod*             summary.table                      
[77] summary.trellis*                    summary.tukeysmooth*               
[79] summary.varComb*                    summary.varConstPower*             
[81] summary.varConstProp*               summary.varExp*                    
[83] summary.varFixed*                   summary.varFunc*                   
[85] summary.varIdent*                   summary.varPower*                  
[87] summary.warnings                   
see '?methods' for accessing help and source code</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Also use the <code>methods(class = ...)</code> function to find all methods that are available for a specific class.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="fu">methods</span>(<span class="at">class =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] add1           alias          anova          case.names     coerce        
 [6] confint        cooks.distance deviance       dfbeta         dfbetas       
[11] drop1          dummy.coef     effects        extractAIC     family        
[16] formula        hatvalues      influence      initialize     kappa         
[21] labels         logLik         model.frame    model.matrix   nobs          
[26] plot           predict        print          proj           qqnorm        
[31] qr             residuals      rstandard      rstudent       show          
[36] simulate       slotsFromS3    summary        variable.names vcov          
see '?methods' for accessing help and source code</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>You can use a dot (<code>.</code>) to reference specific methods, not just generics.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>?summary.lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Summarizing Linear Model Fits

Description:

     'summary' method for class '"lm"'.

Usage:

     ## S3 method for class 'lm'
     summary(object, correlation = FALSE, symbolic.cor = FALSE, ...)
     
     ## S3 method for class 'summary.lm'
     print(x, digits = max(3, getOption("digits") - 3),
           symbolic.cor = x$symbolic.cor,
           signif.stars = getOption("show.signif.stars"), ...)
     
Arguments:

  object: an object of class '"lm"', usually, a result of a call to
          'lm'.

       x: an object of class '"summary.lm"', usually, a result of a
          call to 'summary.lm'.

correlation: logical; if 'TRUE', the correlation matrix of the
          estimated parameters is returned and printed.

  digits: the number of significant digits to use when printing.

symbolic.cor: logical. If 'TRUE', print the correlations in a symbolic
          form (see 'symnum') rather than as numbers.

signif.stars: logical. If 'TRUE', 'significance stars' are printed for
          each coefficient.

     ...: further arguments passed to or from other methods.

Details:

     'print.summary.lm' tries to be smart about formatting the
     coefficients, standard errors, etc. and additionally gives
     'significance stars' if 'signif.stars' is 'TRUE'.

     Aliased coefficients are omitted in the returned object but
     restored by the 'print' method.

     Correlations are printed to two decimal places (or symbolically):
     to see the actual correlations print 'summary(object)$correlation'
     directly.

Value:

     The function 'summary.lm' computes and returns a list of summary
     statistics of the fitted linear model given in 'object', using the
     components (list elements) '"call"' and '"terms"' from its
     argument, plus

residuals: the _weighted_ residuals, the usual residuals rescaled by
          the square root of the weights specified in the call to 'lm'.

coefficients: a p x 4 matrix with columns for the estimated
          coefficient, its standard error, t-statistic and
          corresponding (two-sided) p-value.  Aliased coefficients are
          omitted.

 aliased: named logical vector showing if the original coefficients are
          aliased.

   sigma: the square root of the estimated variance of the random error

                       sigma^2 = 1/(n-p) Sum(w[i] R[i]^2),              
          
          where R[i] is the i-th residual, 'residuals[i]'.

      df: degrees of freedom, a 3-vector (p, n-p, p*), the first being
          the number of non-aliased coefficients, the last being the
          total number of coefficients.

fstatistic: (for models including non-intercept terms) a 3-vector with
          the value of the F-statistic with its numerator and
          denominator degrees of freedom.

r.squared: R^2, the 'fraction of variance explained by the model',

                    R^2 = 1 - Sum(R[i]^2) / Sum((y[i]- y*)^2),          
          
          where y* is the mean of y[i] if there is an intercept and
          zero otherwise.

adj.r.squared: the above R^2 statistic '_adjusted_', penalizing for
          higher p.

cov.unscaled: a p x p matrix of (unscaled) covariances of the coef[j],
          j=1, ..., p.

correlation: the correlation matrix corresponding to the above
          'cov.unscaled', if 'correlation = TRUE' is specified.

symbolic.cor: (only if 'correlation' is true.)  The value of the
          argument 'symbolic.cor'.

na.action: from 'object', if present there.

See Also:

     The model fitting function 'lm', 'summary'.

     Function 'coef' will extract the matrix of coefficients with
     standard errors, t-statistics and p-values.

Examples:

     ##-- Continuing the  lm(.) example:
     coef(lm.D90)  # the bare coefficients
     sld90 &lt;- summary(lm.D90 &lt;- lm(weight ~ group -1))  # omitting intercept
     sld90
     coef(sld90)  # much more
     
     ## model with *aliased* coefficient:
     lm.D9. &lt;- lm(weight ~ group + I(group != "Ctl"))
     Sm.D9. &lt;- summary(lm.D9.)
     Sm.D9. #  shows the NA NA NA NA  line
     stopifnot(length(cc &lt;- coef(lm.D9.)) == 3, is.na(cc[3]),
               dim(coef(Sm.D9.)) == c(2,4), Sm.D9.$df == c(2, 18, 3))</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="part-2-formulas-formulae" class="title-slide slide level1 center">
<h1>Part 2: Formulas / Formulae</h1>

</section>
<section id="utility-of-s3-methods" class="slide level2 scrollable">
<h2>Utility of S3 methods</h2>
<ul>
<li>Hopefully you can now see why understanding S3 methods is important.</li>
<li>But if you aren’t convinced, maybe <code>formula</code> objects can convince you. Look how many methods there are!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a><span class="fu">methods</span>(<span class="at">class =</span> <span class="st">"formula"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] [             aggregate     alias         all.equal     ansari.test  
 [6] barplot       bartlett.test boxplot       cdplot        coerce       
[11] cor.test      deriv         deriv3        fligner.test  formula      
[16] friedman.test ftable        getInitial    head          initialize   
[21] kruskal.test  ks.test       lines         mood.test     mosaicplot   
[26] pairs         plot          points        ppr           prcomp       
[31] princomp      print         quade.test    selfStart     show         
[36] simulate      slotsFromS3   spineplot     stripchart    sunflowerplot
[41] t.test        terms         text          update        var.test     
[46] wilcox.test  
see '?methods' for accessing help and source code</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>And that doesn’t include functions like <code>lm()</code> which ONLY have methods for formulas, not generics.</li>
</ul>
</div>
</section>
<section id="formula-example" class="slide level2 scrollable">
<h2>Formula example</h2>
<ul>
<li>Say you want to get the correlation between MCV1 coverage rate and measles cases in Pakistan. You can call the <code>cor.test()</code> function by passing two vectors.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>meas <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"measles_final.Rds"</span>))</span>
<span id="cb41-2"><a></a></span>
<span id="cb41-3"><a></a><span class="fu">cor.test</span>(</span>
<span id="cb41-4"><a></a>    <span class="at">x =</span> meas<span class="sc">$</span>MCV1_coverage[meas<span class="sc">$</span>iso3c <span class="sc">==</span> <span class="st">"PAK"</span>],</span>
<span id="cb41-5"><a></a>    <span class="at">y =</span> meas<span class="sc">$</span>measles_cases[meas<span class="sc">$</span>iso3c <span class="sc">==</span> <span class="st">"PAK"</span>]</span>
<span id="cb41-6"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  meas$MCV1_coverage[meas$iso3c == "PAK"] and meas$measles_cases[meas$iso3c == "PAK"]
t = -3.2036, df = 41, p-value = 0.002627
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6591955 -0.1699300
sample estimates:
       cor 
-0.4474377 </code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>But if we inspect the methods for <code>cor.test</code>, we see it is an S3 generic with a method for <code>formula</code> class objects.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="fu">methods</span>(cor.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] cor.test.default* cor.test.formula*
see '?methods' for accessing help and source code</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Typing in the code is easier, and reading the output is easier.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a><span class="fu">cor.test</span>(</span>
<span id="cb45-2"><a></a>    <span class="sc">~</span> measles_cases <span class="sc">+</span> MCV1_coverage,</span>
<span id="cb45-3"><a></a>    <span class="at">data =</span> <span class="fu">subset</span>(meas, iso3c <span class="sc">==</span> <span class="st">"PAK"</span>)</span>
<span id="cb45-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  measles_cases and MCV1_coverage
t = -3.2036, df = 41, p-value = 0.002627
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6591955 -0.1699300
sample estimates:
       cor 
-0.4474377 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>But it pays to understand S3, because in certain circumstances, using the default method is easier!</li>
</ul>
</div>
</section>
<section id="writing-formulas" class="slide level2 incremental">
<h2>Writing formulas</h2>
<ul>
<li>The formula language is a smaller language inside of R used for writing statistical models, and the full details <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html">are in the <code>?formula</code> documentation</a>.</li>
<li>This little formula language is so useful it is now used in many textbooks and other languages (Python and Julia).</li>
<li>The basic syntax is <code>dv ~ iv1 + iv2 + ...</code>.</li>
<li>Recall that in <code>cor.test()</code> our formula didn’t have a LHS – there is no dependent variable in correlation.</li>
</ul>
</section>
<section id="you-try-it" class="slide level2 scrollable">
<h2>You try it!</h2>
<ul>
<li>Before, we saw that <code>boxplot</code> had a formula method. Use <code>boxplot()</code> with a formula to make boxplots of measles cases in 2002 for each <code>region</code> in the dataset.</li>
</ul>
<div class="fragment">
<ul>
<li>Hint: your code should look like this for the correct DV and IV.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a><span class="fu">boxplot</span>(dv <span class="sc">~</span> iv, <span class="at">data =</span> <span class="fu">subset</span>(meas, year <span class="sc">==</span> <span class="dv">2002</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Solution:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a></a><span class="fu">boxplot</span>(measles_cases <span class="sc">~</span> region, <span class="at">data =</span> <span class="fu">subset</span>(meas, year <span class="sc">==</span> <span class="dv">2002</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Module06-S3-lm-formulas_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="you-try-it-more-advanced" class="slide level2 scrollable">
<h2>You try it (more advanced)</h2>
<ul>
<li>Load the QCRC dataset, you only need the sheet “Main_Dataset” for this.</li>
<li>Fit a logistic regression model with 30 day mortality (<code>30D_Mortality</code> in the spreadsheet) as the outcome. Include any continuous or categorical predictors you want, we recommend avoiding variables that are (supposed to be) date/times.</li>
<li>Use appropriate S3 generic functions to get statistics about your model that you would want to report.</li>
</ul>
<div class="fragment">
<ul>
<li>Hint: to read in the data, do this.</li>
<li>Hint: you might need to do some data cleaning, because missing data are written as a period in the spreadsheet.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a>qcrc <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(</span>
<span id="cb49-2"><a></a>    here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"QCRC_FINAL_Deidentified.xlsx"</span>),</span>
<span id="cb49-3"><a></a>    <span class="at">sheet =</span> <span class="st">"Main_Dataset"</span></span>
<span id="cb49-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Hint: your logistic regression code should look like this.</li>
<li>Hint: you need to put backticks (this thing: `, NOT an apostrophe. It’s made by the ~ key on american keyboards.) around the name of the variable `30D_Mortality`.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a></a>model_30dm <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb50-2"><a></a>    something <span class="sc">~</span> something <span class="sc">+</span> something <span class="sc">+</span> ...,</span>
<span id="cb50-3"><a></a>    <span class="at">data =</span> qcrc,</span>
<span id="cb50-4"><a></a>    <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb50-5"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Hint: some useful functions with methods for <code>glm</code>-class objects are <code>summary</code>, <code>coef</code>, and <code>confint</code>. (You probably also need the function <code>exp</code>!)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>One solution, you could have used any predictors you want, though you should be able to explain why they might affect 30 Day mortality.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="co"># A little cleaning for D Dimer</span></span>
<span id="cb51-2"><a></a><span class="co"># First turn the "." into actual NA's and make it a real number</span></span>
<span id="cb51-3"><a></a>qcrc<span class="sc">$</span>d_dimer <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dplyr<span class="sc">::</span><span class="fu">na_if</span>(qcrc<span class="sc">$</span><span class="st">`</span><span class="at">D dimer</span><span class="st">`</span>, <span class="st">"."</span>))</span>
<span id="cb51-4"><a></a><span class="co"># Take the log cause it's skewed and positive</span></span>
<span id="cb51-5"><a></a>qcrc<span class="sc">$</span>d_dimer <span class="ot">&lt;-</span> <span class="fu">log</span>(qcrc<span class="sc">$</span>d_dimer)</span>
<span id="cb51-6"><a></a><span class="co"># Impute missing values with the median -- there are much better ways to do this</span></span>
<span id="cb51-7"><a></a>med_d_dimer <span class="ot">&lt;-</span> <span class="fu">median</span>(qcrc<span class="sc">$</span>d_dimer, <span class="at">na.rm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-8"><a></a>qcrc<span class="sc">$</span>d_dimer <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(qcrc<span class="sc">$</span>d_dimer), med_d_dimer, qcrc<span class="sc">$</span>d_dimer)</span>
<span id="cb51-9"><a></a></span>
<span id="cb51-10"><a></a><span class="co"># A little cleaning for Race</span></span>
<span id="cb51-11"><a></a>qcrc<span class="sc">$</span>Race <span class="ot">&lt;-</span> <span class="fu">factor</span>(qcrc<span class="sc">$</span>Race) <span class="sc">|&gt;</span></span>
<span id="cb51-12"><a></a>    <span class="co"># Make White the reference level</span></span>
<span id="cb51-13"><a></a>    <span class="fu">relevel</span>(<span class="at">ref =</span> <span class="st">"Caucasian or White"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-14"><a></a>    <span class="co"># Groups other than "Causian or White" and "Black or African American" are</span></span>
<span id="cb51-15"><a></a>    <span class="co"># really small and heterogeneous so put them together</span></span>
<span id="cb51-16"><a></a>    <span class="co"># Not ideal but sometimes the best we can do</span></span>
<span id="cb51-17"><a></a>    forcats<span class="sc">::</span><span class="fu">fct_lump_n</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb51-18"><a></a></span>
<span id="cb51-19"><a></a><span class="co"># Fit a model that controls for treatment, d_dimer, and race/ethnicity</span></span>
<span id="cb51-20"><a></a>model_30dm <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb51-21"><a></a>    <span class="st">`</span><span class="at">30D_Mortality</span><span class="st">`</span> <span class="sc">~</span> Remdesivir_or_placebo <span class="sc">+</span> d_dimer <span class="sc">+</span> Race,</span>
<span id="cb51-22"><a></a>    <span class="at">data =</span> qcrc,</span>
<span id="cb51-23"><a></a>    <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb51-24"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Look at a lot of useful information with <code>summary()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a></a><span class="fu">summary</span>(model_30dm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = `30D_Mortality` ~ Remdesivir_or_placebo + d_dimer + 
    Race, family = "binomial", data = qcrc)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                     -2.4352     0.8190  -2.973  0.00295 **
Remdesivir_or_placebo           -0.7004     0.4105  -1.706  0.08793 . 
d_dimer                          0.1848     0.1015   1.820  0.06871 . 
RaceAfrican American  or Black   0.2738     0.3899   0.702  0.48260   
RaceOther                        0.7733     0.4990   1.550  0.12119   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 317.14  on 256  degrees of freedom
Residual deviance: 308.52  on 252  degrees of freedom
  (31 observations deleted due to missingness)
AIC: 318.52

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Get the OR’s with <code>coef()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a></a><span class="fu">coef</span>(model_30dm) <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a></a>    <span class="fu">exp</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a></a>    <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   (Intercept)          Remdesivir_or_placebo 
                          0.09                           0.50 
                       d_dimer RaceAfrican American  or Black 
                          1.20                           1.31 
                     RaceOther 
                          2.17 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Get the profile CI’s with <code>confint()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a></a><span class="fu">confint</span>(model_30dm) <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a></a>    <span class="fu">exp</span>() <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a></a>    <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2.5 %</th>
<th style="text-align: right;">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">Remdesivir_or_placebo</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">1.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">d_dimer</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">RaceAfrican American or Black</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">2.93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RaceOther</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">5.86</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>A basic interpretation of the coefficient for <code>Remdesivir_or_placebo</code> (coded as 1 for remdesivir and 0 for placebo) might be “Odds of mortality after 30 days in the remdesivisir group were 0.48 times the odds in the placebo group, for patients with the same D dimer level and race/ethnicity. The 95% CI for the odds ratio was 0.20 to 1.04. The effect was not significant at the <span class="math inline">\(\alpha = 0.05\)</span> significance group, but is suggestive that at least some patients benefitted from remdesivir treatment.”</li>
</ul>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>We learned the basics of “functional OOP” and specifically R’s S3 system, including how to check classes and find S3 methods for a class or classes for an S3 method.</li>
<li>We learned the basics of R formulas, a consistent and powerful sub-language in R for writing statistical models.</li>
<li>There’s a lot more to formulas, but we’ll discuss them more in a separate module based on interest/time.</li>
<li>If you want to read more about S3 or OOP in R, check out <a href="https://adv-r.hadley.nz/oo.html">the OOP section in Wickham’s Advanced R</a>.</li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>