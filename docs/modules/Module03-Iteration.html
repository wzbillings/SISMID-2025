<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.510">

  <meta name="author" content="Alex Edwards">
  <meta name="author" content="Zane Billings">
  <title>SISMID R for ID Materials (2025) - Module 3: Iteration and vectorization in R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Module 3: Iteration and vectorization in R</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://sph.emory.edu/profile/faculty/alex-edwards">Alex Edwards</a> 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://wzbillings.com/">Zane Billings</a> 
</div>
</div>
</div>

</section>
<section id="learning-goals" class="slide level2">
<h2>Learning goals</h2>
<ol type="1">
<li>Replace repetitive code with a <code>for</code> loop</li>
<li>Use vectorization to replace unnecessary loops</li>
</ol>
</section>
<section id="repeating-code" class="slide level2">
<h2>Repeating code</h2>
<ul>
<li>We often want to run the same code many times, replacing just one or a few parts.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">data</span>(<span class="st">"penguins"</span>, <span class="at">package =</span> <span class="st">"palmerpenguins"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Biscoe"</span>] <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Dream"</span>] <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18.34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Torgersen"</span>] <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18.43</code></pre>
</div>
</div>
<ul>
<li>We can do this ourselves if we only have a small list of changes. But imagine if there were 1000 islands instead!</li>
</ul>
</section>
<section id="what-is-iteration" class="slide level2">
<h2>What is iteration?</h2>
<ul>
<li>Whenever you repeat something, that’s iteration.</li>
<li>In <code>R</code>, this means running the same code multiple times in a row.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">for</span> (this_island <span class="cf">in</span> <span class="fu">levels</span>(penguins<span class="sc">$</span>island)) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>    island_mean <span class="ot">&lt;-</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>        penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> this_island] <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>    </span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, this_island, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                            <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb7-9"><a href="#cb7-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean bill depth on Biscoe Island was 15.87 mm.
The mean bill depth on Dream Island was 18.34 mm.
The mean bill depth on Torgersen Island was 18.43 mm.</code></pre>
</div>
</div>
</section>
<section id="parts-of-a-loop" class="slide level2">
<h2>Parts of a loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="1,9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="cf">for</span> (this_island <span class="cf">in</span> <span class="fu">levels</span>(penguins<span class="sc">$</span>island)) {</span>
<span id="cb9-2"><a href="#cb9-2"></a>    island_mean <span class="ot">&lt;-</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>        penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> this_island] <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a>    </span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, this_island, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb9-8"><a href="#cb9-8"></a>                            <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb9-9"><a href="#cb9-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <strong>header</strong> declares how many times we will repeat the same code. The header contains a <strong>control variable</strong> that changes in each repetition and a <strong>sequence</strong> of values for the control variable to take.</p>
</section>
<section id="parts-of-a-loop-1" class="slide level2">
<h2>Parts of a loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="2-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="cf">for</span> (this_island <span class="cf">in</span> <span class="fu">levels</span>(penguins<span class="sc">$</span>island)) {</span>
<span id="cb10-2"><a href="#cb10-2"></a>    island_mean <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>        penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> this_island] <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>    </span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, this_island, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb10-8"><a href="#cb10-8"></a>                            <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb10-9"><a href="#cb10-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <strong>body</strong> of the loop contains code that will be repeated a number of times based on the header instructions. In <code>R</code>, the body has to be surrounded by curly braces.</p>
</section>
<section id="header-parts" class="slide level2">
<h2>Header parts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="cf">for</span> (this_island <span class="cf">in</span> <span class="fu">levels</span>(penguins<span class="sc">$</span>island)) {...}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>for</code>: keyword that declares we are doing a for loop.</li>
<li><code>(...)</code>: parentheses after <code>for</code> declare the control variable and sequence.</li>
<li><code>this_island</code>: the control variable.</li>
<li><code>in</code>: keyword that separates the control varibale and sequence.</li>
<li><code>levels(penguins$island)</code>: the sequence.</li>
<li><code>{}</code>: curly braces will contain the body code.</li>
</ul>
</section>
<section id="header-parts-1" class="slide level2">
<h2>Header parts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="cf">for</span> (this_island <span class="cf">in</span> <span class="fu">levels</span>(penguins<span class="sc">$</span>island)) {...}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Since <code>levels(penguins$island)</code> evaluates to <code>c("Biscoe", "Dream", "Torgersen")</code>, our loop will repeat 3 times.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Iteration</th>
<th><code>this_island</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>“Biscoe”</td>
</tr>
<tr class="even">
<td>2</td>
<td>“Dream”</td>
</tr>
<tr class="odd">
<td>3</td>
<td>“Torgersen”</td>
</tr>
</tbody>
</table>
<ul>
<li>Everything inside of <code>{...}</code> will be repeated three times.</li>
</ul>
</section>
<section id="loop-iteration-1" class="slide level2">
<h2>Loop iteration 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>island_mean <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>    penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Biscoe"</span>] <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, <span class="st">"Biscoe"</span>, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb13-7"><a href="#cb13-7"></a>                    <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean bill depth on Biscoe Island was 15.87 mm.</code></pre>
</div>
</div>
</section>
<section id="loop-iteration-2" class="slide level2">
<h2>Loop iteration 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>island_mean <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>    penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Dream"</span>] <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, <span class="st">"Dream"</span>, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                    <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean bill depth on Dream Island was 18.34 mm.</code></pre>
</div>
</div>
</section>
<section id="loop-iteration-3" class="slide level2">
<h2>Loop iteration 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>island_mean <span class="ot">&lt;-</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>    penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Torgersen"</span>] <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, <span class="st">"Torgersen"</span>, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb17-7"><a href="#cb17-7"></a>                    <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean bill depth on Torgersen Island was 18.43 mm.</code></pre>
</div>
</div>
</section>
<section id="the-loop-structure-automates-this-process-for-us-so-we-dont-have-to-copy-and-paste-our-code" class="slide level2">
<h2>The loop structure automates this process for us so we don’t have to copy and paste our code!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="cf">for</span> (this_island <span class="cf">in</span> <span class="fu">levels</span>(penguins<span class="sc">$</span>island)) {</span>
<span id="cb19-2"><a href="#cb19-2"></a>    island_mean <span class="ot">&lt;-</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>        penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> this_island] <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>        <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>        <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a>    </span>
<span id="cb19-7"><a href="#cb19-7"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"The mean bill depth on"</span>, this_island, <span class="st">"Island was"</span>, island_mean,</span>
<span id="cb19-8"><a href="#cb19-8"></a>                            <span class="st">"mm.</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb19-9"><a href="#cb19-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean bill depth on Biscoe Island was 15.87 mm.
The mean bill depth on Dream Island was 18.34 mm.
The mean bill depth on Torgersen Island was 18.43 mm.</code></pre>
</div>
</div>
</section>
<section id="side-note-the-pipe-operator" class="slide level2 scrollable">
<h2>Side note: the pipe operator <code>|&gt;</code></h2>
<ul>
<li>This operator allows us to chain commands together so the output of the previous statement is passed into the next statement.</li>
<li>E.g. the code</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>island_mean <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>    penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Torgersen"</span>] <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>    <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>will be transformed by R into</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>island_mean <span class="ot">&lt;-</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>    <span class="fu">round</span>(</span>
<span id="cb22-3"><a href="#cb22-3"></a>        <span class="fu">mean</span>(</span>
<span id="cb22-4"><a href="#cb22-4"></a>            penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Torgersen"</span>],</span>
<span id="cb22-5"><a href="#cb22-5"></a>            <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>        ),</span>
<span id="cb22-7"><a href="#cb22-7"></a>        <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>before it gets run. So using the pipe is a way to avoid deeply nested functions.</p>
<p>Note that another alernative could be like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>island_data <span class="ot">&lt;-</span> penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>island <span class="sc">==</span> <span class="st">"Torgersen"</span>]</span>
<span id="cb23-2"><a href="#cb23-2"></a>island_mean_raw <span class="ot">&lt;-</span> <span class="fu">mean</span>(island_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>island_mean <span class="ot">&lt;-</span> <span class="fu">round</span>(island_mean_raw, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So using <code>|&gt;</code> can also help us to avoid a lot of assignments.</p>
<ul>
<li><strong>Whichever style you prefer is fine!</strong> Some people like the pipe, some people like nesting, and some people like intermediate assignments. All three are perfectly fine as long as your code is neat and commented.</li>
<li>If you go on to the <code>tidyverse</code> class, you will use a lot of piping – it is a very popular coding style in R these days thanks to the inventors of the <code>tidyverse</code> packages.</li>
<li>Also note that you need R version 4.1.0 or better to use <code>|&gt;</code>. If you are on an older version of R, it will not be available.</li>
</ul>
<p><strong>Now, back to loops!</strong></p>
</section>
<section id="remember-write-dry-code" class="slide level2">
<h2>Remember: write DRY code!</h2>
<ul>
<li>DRY = “Don’t Repeat Yourself”</li>
<li>Instead of copying and pasting, write loops and functions.</li>
<li>Easier to debug and change in the future!</li>
</ul>
<div class="fragment">
<ul>
<li>Of course, we all copy and paste code sometimes. If you are running on a tight deadline or can’t get a loop or function to work, you might need to. <strong>DRY code is good, but working code is best!</strong></li>
</ul>
</div>
</section>
<section id="tweet-slide" class="slide level2 center" data-menu-title="Hadley tweet">
<h2></h2>

<img data-src="../images/hadley-tweet.PNG" class="r-stretch"></section>
<section id="you-try-it" class="slide level2">
<h2>You try it!</h2>
<p>Write a loop that goes from 1 to 10, squares each of the numbers, and prints the squared number.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb24-2"><a href="#cb24-2"></a>    <span class="fu">cat</span>(i <span class="sc">^</span> <span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 
4 
9 
16 
25 
36 
49 
64 
81 
100 </code></pre>
</div>
</div>
</div>
</section>
<section id="wait-did-we-need-to-do-that" class="slide level2 incremental">
<h2>Wait, did we need to do that?</h2>
<ul>
<li>Well, yes, because you need to practice loops!</li>
<li>But technically no, because we can use <strong>vectorization</strong>.</li>
<li>Almost all basic operations in R are <strong>vectorized</strong>: they work on a vector of arguments all at the same time.</li>
</ul>
</section>
<section id="wait-did-we-need-to-do-that-1" class="slide level2 scrollable">
<h2>Wait, did we need to do that?</h2>
<ul>
<li>Well, yes, because you need to practice loops!</li>
<li>But technically no, because we can use <strong>vectorization</strong>.</li>
<li>Almost all basic operations in R are <strong>vectorized</strong>: they work on a vector of arguments all at the same time.</li>
<li>(Technical note: actually, vectorized operations still do a loop. But they do the loop inside a compiled C program, which is much faster than R loops.)</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># No loop needed!</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Get the first 10 odd numbers, a common CS 101 loop problem on exams</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)[<span class="fu">which</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> <span class="sc">%%</span> <span class="dv">2</span>) <span class="sc">==</span> <span class="dv">1</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  3  5  7  9 11 13 15 17 19</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>So you should really try vectorization first, then use loops only when you can’t use vectorization.</li>
</ul>
</div>
</section>
<section id="loop-walkthrough" class="slide level2">
<h2>Loop walkthrough</h2>
<ul>
<li>Let’s walk through a complex but useful example where we can’t use vectorization.</li>
<li>Load the cleaned measles dataset, and subset it so you only have MCV1 records.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>meas <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"measles_final.Rds"</span>))</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">str</span>(meas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [9,416 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ iso3c        : chr [1:9416] "AFG" "AFG" "AFG" "AFG" ...
 $ year         : num [1:9416] 2023 2022 2021 2020 2019 ...
 $ measles_cases: num [1:9416] 2792 5166 2900 640 353 ...
 $ population   : num [1:9416] 42239854 41128771 40099462 38972230 37769499 ...
 $ MCV1_coverage: num [1:9416] NA 68 63 66 64 71 67 64 62 60 ...
 $ MCV2_coverage: num [1:9416] NA 49 44 43 41 49 40 40 42 44 ...
 $ country      : chr [1:9416] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...
 $ region       : chr [1:9416] "Asia" "Asia" "Asia" "Asia" ...
 $ sub_region   : chr [1:9416] "Southern Asia" "Southern Asia" "Southern Asia" "Southern Asia" ...
 - attr(*, "spec")=List of 3
  ..$ cols   :List of 6
  .. ..$ iso3c        : list()
  .. .. ..- attr(*, "class")= chr [1:2] "collector_character" "collector"
  .. ..$ year         : list()
  .. .. ..- attr(*, "class")= chr [1:2] "collector_double" "collector"
  .. ..$ measles_cases: list()
  .. .. ..- attr(*, "class")= chr [1:2] "collector_double" "collector"
  .. ..$ population   : list()
  .. .. ..- attr(*, "class")= chr [1:2] "collector_double" "collector"
  .. ..$ MCV1_coverage: list()
  .. .. ..- attr(*, "class")= chr [1:2] "collector_double" "collector"
  .. ..$ MCV2_coverage: list()
  .. .. ..- attr(*, "class")= chr [1:2] "collector_double" "collector"
  ..$ default: list()
  .. ..- attr(*, "class")= chr [1:2] "collector_guess" "collector"
  ..$ delim  : chr ","
  ..- attr(*, "class")= chr "col_spec"
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</div>
</section>
<section id="loop-walkthrough-1" class="slide level2">
<h2>Loop walkthrough</h2>
<ul>
<li>First, make an empty <code>list</code>. This is where we’ll store our results. Make it the same length as the number of countries in the dataset.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(<span class="fu">unique</span>(meas<span class="sc">$</span>country)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>This is called <em>preallocation</em> and it can make your loops much faster.</li>
</ul>
</div>
</section>
<section id="loop-walkthrough-2" class="slide level2">
<h2>Loop walkthrough</h2>
<ul>
<li>Loop through every country in the dataset, and get the median, first and third quartiles, and range for each country. Store those summary statistics in a data frame.</li>
<li>What should the header look like?</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(meas<span class="sc">$</span>country)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {...}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Note that we use the <strong>index</strong> as the control variable. When you need to do complex operations inside a loop, this is easier than the <strong>for-each</strong> construction we used earlier.</li>
</ul>
</div>
</section>
<section id="loop-walkthrough-3" class="slide level2 scrollable">
<h2>Loop walkthrough</h2>
<ul>
<li>Now write out the body of the code. First we need to subset the data, to get only the data for the current country.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {</span>
<span id="cb34-2"><a href="#cb34-2"></a>    <span class="co"># Get the data for the current country only</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>    country_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(meas, country <span class="sc">==</span> countries[i])</span>
<span id="cb34-4"><a href="#cb34-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Next we need to get the summary of the cases for that country.</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {</span>
<span id="cb35-2"><a href="#cb35-2"></a>    <span class="co"># Get the data for the current country only</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>    country_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(meas, country <span class="sc">==</span> countries[i])</span>
<span id="cb35-4"><a href="#cb35-4"></a>    </span>
<span id="cb35-5"><a href="#cb35-5"></a>    <span class="co"># Get the summary statistics for this country</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>    country_cases <span class="ot">&lt;-</span> country_data<span class="sc">$</span>measles_cases</span>
<span id="cb35-7"><a href="#cb35-7"></a>    country_quart <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb35-8"><a href="#cb35-8"></a>        country_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a>    )</span>
<span id="cb35-10"><a href="#cb35-10"></a>    country_range <span class="ot">&lt;-</span> <span class="fu">range</span>(country_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-11"><a href="#cb35-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>Next we save the summary statistics into a data frame.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {</span>
<span id="cb36-2"><a href="#cb36-2"></a>    <span class="co"># Get the data for the current country only</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>    country_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(meas, country <span class="sc">==</span> countries[i])</span>
<span id="cb36-4"><a href="#cb36-4"></a>    </span>
<span id="cb36-5"><a href="#cb36-5"></a>    <span class="co"># Get the summary statistics for this country</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>    country_cases <span class="ot">&lt;-</span> country_data<span class="sc">$</span>measles_cases</span>
<span id="cb36-7"><a href="#cb36-7"></a>    country_quart <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb36-8"><a href="#cb36-8"></a>        country_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb36-9"><a href="#cb36-9"></a>    )</span>
<span id="cb36-10"><a href="#cb36-10"></a>    country_range <span class="ot">&lt;-</span> <span class="fu">range</span>(country_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-11"><a href="#cb36-11"></a>    </span>
<span id="cb36-12"><a href="#cb36-12"></a>    <span class="co"># Save the summary statistics into a data frame</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>    country_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-14"><a href="#cb36-14"></a>        <span class="at">country =</span> countries[[i]],</span>
<span id="cb36-15"><a href="#cb36-15"></a>        <span class="at">min =</span> country_range[[<span class="dv">1</span>]],</span>
<span id="cb36-16"><a href="#cb36-16"></a>        <span class="at">Q1 =</span> country_quart[[<span class="dv">1</span>]],</span>
<span id="cb36-17"><a href="#cb36-17"></a>        <span class="at">median =</span> country_quart[[<span class="dv">2</span>]],</span>
<span id="cb36-18"><a href="#cb36-18"></a>        <span class="at">Q3 =</span> country_quart[[<span class="dv">3</span>]],</span>
<span id="cb36-19"><a href="#cb36-19"></a>        <span class="at">max =</span> country_range[[<span class="dv">2</span>]]</span>
<span id="cb36-20"><a href="#cb36-20"></a>    )</span>
<span id="cb36-21"><a href="#cb36-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>And finally, we save the data frame as the next element in our storage list.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {</span>
<span id="cb37-2"><a href="#cb37-2"></a>    <span class="co"># Get the data for the current country only</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>    country_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(meas, country <span class="sc">==</span> countries[i])</span>
<span id="cb37-4"><a href="#cb37-4"></a>    </span>
<span id="cb37-5"><a href="#cb37-5"></a>    <span class="co"># Get the summary statistics for this country</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>    country_cases <span class="ot">&lt;-</span> country_data<span class="sc">$</span>measles_cases</span>
<span id="cb37-7"><a href="#cb37-7"></a>    country_quart <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb37-8"><a href="#cb37-8"></a>        country_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb37-9"><a href="#cb37-9"></a>    )</span>
<span id="cb37-10"><a href="#cb37-10"></a>    country_range <span class="ot">&lt;-</span> <span class="fu">range</span>(country_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-11"><a href="#cb37-11"></a>    </span>
<span id="cb37-12"><a href="#cb37-12"></a>    <span class="co"># Save the summary statistics into a data frame</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>    country_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-14"><a href="#cb37-14"></a>        <span class="at">country =</span> countries[[i]],</span>
<span id="cb37-15"><a href="#cb37-15"></a>        <span class="at">min =</span> country_range[[<span class="dv">1</span>]],</span>
<span id="cb37-16"><a href="#cb37-16"></a>        <span class="at">Q1 =</span> country_quart[[<span class="dv">1</span>]],</span>
<span id="cb37-17"><a href="#cb37-17"></a>        <span class="at">median =</span> country_quart[[<span class="dv">2</span>]],</span>
<span id="cb37-18"><a href="#cb37-18"></a>        <span class="at">Q3 =</span> country_quart[[<span class="dv">3</span>]],</span>
<span id="cb37-19"><a href="#cb37-19"></a>        <span class="at">max =</span> country_range[[<span class="dv">2</span>]]</span>
<span id="cb37-20"><a href="#cb37-20"></a>    )</span>
<span id="cb37-21"><a href="#cb37-21"></a>    </span>
<span id="cb37-22"><a href="#cb37-22"></a>    <span class="co"># Save the results to our container</span></span>
<span id="cb37-23"><a href="#cb37-23"></a>    res[[i]] <span class="ot">&lt;-</span> country_summary</span>
<span id="cb37-24"><a href="#cb37-24"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in min(x): no non-missing arguments to min; returning Inf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in max(x): no non-missing arguments to max; returning -Inf</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Let’s take a look at the results.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">head</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
      country min   Q1 median     Q3   max
1 Afghanistan 353 1158 2345.5 6190.5 32455

[[2]]
  country min Q1 median Q3    max
1 Albania   0  1     12 29 136034

[[3]]
  country min  Q1 median   Q3   max
1 Algeria   0 112   2686 8204 29584

[[4]]
         country min Q1 median  Q3 max
1 American Samoa   0  0      0 2.5 498

[[5]]
  country min Q1 median Q3 max
1 Andorra   0  0      0  0   5

[[6]]
  country min    Q1 median    Q3   max
1  Angola  29 732.5 3389.5 15878 30067</code></pre>
</div>
</div>
<ul>
<li>How do we deal with this to get it into a nice form?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We can use a <em>vectorization</em> trick: the function <code>do.call()</code> seems like ancient computer science magic. And it is. But it will actually help us a lot.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>res_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, res)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">head</span>(res_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">353</td>
<td style="text-align: right;">1158.0</td>
<td style="text-align: right;">2345.5</td>
<td style="text-align: right;">6190.5</td>
<td style="text-align: right;">32455</td>
</tr>
<tr class="even">
<td style="text-align: left;">Albania</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">29.0</td>
<td style="text-align: right;">136034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Algeria</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">112.0</td>
<td style="text-align: right;">2686.0</td>
<td style="text-align: right;">8204.0</td>
<td style="text-align: right;">29584</td>
</tr>
<tr class="even">
<td style="text-align: left;">American Samoa</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">498</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Andorra</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Angola</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">732.5</td>
<td style="text-align: right;">3389.5</td>
<td style="text-align: right;">15878.0</td>
<td style="text-align: right;">30067</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>It combined our data frames together! Let’s take a look at the <code>rbind</code> and <code>do.call()</code> help packages to see what happened.</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>?rbind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combine R Objects by Rows or Columns

Description:

     Take a sequence of vector, matrix or data-frame arguments and
     combine by _c_olumns or _r_ows, respectively.  These are generic
     functions with methods for other R classes.

Usage:

     cbind(..., deparse.level = 1)
     rbind(..., deparse.level = 1)
     ## S3 method for class 'data.frame'
     rbind(..., deparse.level = 1, make.row.names = TRUE,
           stringsAsFactors = FALSE, factor.exclude = TRUE)
     
Arguments:

     ...: (generalized) vectors or matrices.  These can be given as
          named arguments.  Other R objects may be coerced as
          appropriate, or S4 methods may be used: see sections
          'Details' and 'Value'.  (For the '"data.frame"' method of
          'cbind' these can be further arguments to 'data.frame' such
          as 'stringsAsFactors'.)

deparse.level: integer controlling the construction of labels in the
          case of non-matrix-like arguments (for the default method):
          'deparse.level = 0' constructs no labels;
          the default 'deparse.level = 1' typically and 'deparse.level
          = 2' always construct labels from the argument names, see the
          'Value' section below.

make.row.names: (only for data frame method:) logical indicating if
          unique and valid 'row.names' should be constructed from the
          arguments.

stringsAsFactors: logical, passed to 'as.data.frame'; only has an
          effect when the '...' arguments contain a (non-'data.frame')
          'character'.

factor.exclude: if the data frames contain factors, the default 'TRUE'
          ensures that 'NA' levels of factors are kept, see PR#17562
          and the 'Data frame methods'.  In R versions up to 3.6.x,
          'factor.exclude = NA' has been implicitly hardcoded (R &lt;=
          3.6.0) or the default (R = 3.6.x, x &gt;= 1).

Details:

     The functions 'cbind' and 'rbind' are S3 generic, with methods for
     data frames.  The data frame method will be used if at least one
     argument is a data frame and the rest are vectors or matrices.
     There can be other methods; in particular, there is one for time
     series objects.  See the section on 'Dispatch' for how the method
     to be used is selected.  If some of the arguments are of an S4
     class, i.e., 'isS4(.)' is true, S4 methods are sought also, and
     the hidden 'cbind' / 'rbind' functions from package 'methods'
     maybe called, which in turn build on 'cbind2' or 'rbind2',
     respectively.  In that case, 'deparse.level' is obeyed, similarly
     to the default method.

     In the default method, all the vectors/matrices must be atomic
     (see 'vector') or lists.  Expressions are not allowed.  Language
     objects (such as formulae and calls) and pairlists will be coerced
     to lists: other objects (such as names and external pointers) will
     be included as elements in a list result.  Any classes the inputs
     might have are discarded (in particular, factors are replaced by
     their internal codes).

     If there are several matrix arguments, they must all have the same
     number of columns (or rows) and this will be the number of columns
     (or rows) of the result.  If all the arguments are vectors, the
     number of columns (rows) in the result is equal to the length of
     the longest vector.  Values in shorter arguments are recycled to
     achieve this length (with a 'warning' if they are recycled only
     _fractionally_).

     When the arguments consist of a mix of matrices and vectors the
     number of columns (rows) of the result is determined by the number
     of columns (rows) of the matrix arguments.  Any vectors have their
     values recycled or subsetted to achieve this length.

     For 'cbind' ('rbind'), vectors of zero length (including 'NULL')
     are ignored unless the result would have zero rows (columns), for
     S compatibility.  (Zero-extent matrices do not occur in S3 and are
     not ignored in R.)

     Matrices are restricted to less than 2^31 rows and columns even on
     64-bit systems.  So input vectors have the same length
     restriction: as from R 3.2.0 input matrices with more elements
     (but meeting the row and column restrictions) are allowed.

Value:

     For the default method, a matrix combining the '...' arguments
     column-wise or row-wise.  (Exception: if there are no inputs or
     all the inputs are 'NULL', the value is 'NULL'.)

     The type of a matrix result determined from the highest type of
     any of the inputs in the hierarchy raw &lt; logical &lt; integer &lt;
     double &lt; complex &lt; character &lt; list .

     For 'cbind' ('rbind') the column (row) names are taken from the
     'colnames' ('rownames') of the arguments if these are matrix-like.
     Otherwise from the names of the arguments or where those are not
     supplied and 'deparse.level &gt; 0', by deparsing the expressions
     given, for 'deparse.level = 1' only if that gives a sensible name
     (a 'symbol', see 'is.symbol').

     For 'cbind' row names are taken from the first argument with
     appropriate names: rownames for a matrix, or names for a vector of
     length the number of rows of the result.

     For 'rbind' column names are taken from the first argument with
     appropriate names: colnames for a matrix, or names for a vector of
     length the number of columns of the result.

Data frame methods:

     The 'cbind' data frame method is just a wrapper for
     'data.frame(..., check.names = FALSE)'.  This means that it will
     split matrix columns in data frame arguments.

     The 'rbind' data frame method first drops all zero-column and
     zero-row arguments.  (If that leaves none, it returns the first
     argument with columns otherwise a zero-column zero-row data
     frame.)  It then takes the classes of the columns from the first
     data frame, and matches columns by name (rather than by position).
     Factors have their levels expanded as necessary (in the order of
     the levels of the level sets of the factors encountered) and the
     result is an ordered factor if and only if all the components were
     ordered factors.  Old-style categories (integer vectors with
     levels) are promoted to factors.

     Note that for result column 'j', 'factor(., exclude = X(j))' is
     applied, where

       X(j) := if(isTRUE(factor.exclude)) {
                  if(!NA.lev[j]) NA # else NULL
               } else factor.exclude
     
     where 'NA.lev[j]' is true iff any contributing data frame has had
     a 'factor' in column 'j' with an explicit 'NA' level.

Dispatch:

     The method dispatching is _not_ done via 'UseMethod()', but by
     C-internal dispatching.  Therefore there is no need for, e.g.,
     'rbind.default'.

     The dispatch algorithm is described in the source file
     ('.../src/main/bind.c') as

       1. For each argument we get the list of possible class
          memberships from the class attribute.

       2. We inspect each class in turn to see if there is an
          applicable method.

       3. If we find a method, we use it.  Otherwise, if there was an
          S4 object among the arguments, we try S4 dispatch; otherwise,
          we use the default code.

     If you want to combine other objects with data frames, it may be
     necessary to coerce them to data frames first.  (Note that this
     algorithm can result in calling the data frame method if all the
     arguments are either data frames or vectors, and this will result
     in the coercion of character vectors to factors.)

References:

     Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) _The New S
     Language_.  Wadsworth &amp; Brooks/Cole.

See Also:

     'c' to combine vectors (and lists) as vectors, 'data.frame' to
     combine vectors and matrices as a data frame.

Examples:

     m &lt;- cbind(1, 1:7) # the '1' (= shorter vector) is recycled
     m
     m &lt;- cbind(m, 8:14)[, c(1, 3, 2)] # insert a column
     m
     cbind(1:7, diag(3)) # vector is subset -&gt; warning
     
     cbind(0, rbind(1, 1:3))
     cbind(I = 0, X = rbind(a = 1, b = 1:3))  # use some names
     xx &lt;- data.frame(I = rep(0,2))
     cbind(xx, X = rbind(a = 1, b = 1:3))   # named differently
     
     cbind(0, matrix(1, nrow = 0, ncol = 4)) #&gt; Warning (making sense)
     dim(cbind(0, matrix(1, nrow = 2, ncol = 0))) #-&gt; 2 x 1
     
     ## deparse.level
     dd &lt;- 10
     rbind(1:4, c = 2, "a++" = 10, dd, deparse.level = 0) # middle 2 rownames
     rbind(1:4, c = 2, "a++" = 10, dd, deparse.level = 1) # 3 rownames (default)
     rbind(1:4, c = 2, "a++" = 10, dd, deparse.level = 2) # 4 rownames
     
     ## cheap row names:
     b0 &lt;- gl(3,4, labels=letters[1:3])
     bf &lt;- setNames(b0, paste0("o", seq_along(b0)))
     df  &lt;- data.frame(a = 1, B = b0, f = gl(4,3))
     df. &lt;- data.frame(a = 1, B = bf, f = gl(4,3))
     new &lt;- data.frame(a = 8, B ="B", f = "1")
     (df1  &lt;- rbind(df , new))
     (df.1 &lt;- rbind(df., new))
     stopifnot(identical(df1, rbind(df,  new, make.row.names=FALSE)),
               identical(df1, rbind(df., new, make.row.names=FALSE)))</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>?do.call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Execute a Function Call

Description:

     'do.call' constructs and executes a function call from a name or a
     function and a list of arguments to be passed to it.

Usage:

     do.call(what, args, quote = FALSE, envir = parent.frame())
     
Arguments:

    what: either a function or a non-empty character string naming the
          function to be called.

    args: a _list_ of arguments to the function call.  The 'names'
          attribute of 'args' gives the argument names.

   quote: a logical value indicating whether to quote the arguments.

   envir: an environment within which to evaluate the call.  This will
          be most useful if 'what' is a character string and the
          arguments are symbols or quoted expressions.

Details:

     If 'quote' is 'FALSE', the default, then the arguments are
     evaluated (in the calling environment, not in 'envir').  If
     'quote' is 'TRUE' then each argument is quoted (see 'quote') so
     that the effect of argument evaluation is to remove the quotes -
     leaving the original arguments unevaluated when the call is
     constructed.

     The behavior of some functions, such as 'substitute', will not be
     the same for functions evaluated using 'do.call' as if they were
     evaluated from the interpreter.  The precise semantics are
     currently undefined and subject to change.

Value:

     The result of the (evaluated) function call.

Warning:

     This should not be used to attempt to evade restrictions on the
     use of '.Internal' and other non-API calls.

References:

     Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) _The New S
     Language_.  Wadsworth &amp; Brooks/Cole.

See Also:

     'call' which creates an unevaluated call.

Examples:

     do.call("complex", list(imaginary = 1:3))
     
     ## if we already have a list (e.g., a data frame)
     ## we need c() to add further arguments
     tmp &lt;- expand.grid(letters[1:2], 1:3, c("+", "-"))
     do.call("paste", c(tmp, sep = ""))
     
     do.call(paste, list(as.name("A"), as.name("B")), quote = TRUE)
     
     ## examples of where objects will be found.
     A &lt;- 2
     f &lt;- function(x) print(x^2)
     env &lt;- new.env()
     assign("A", 10, envir = env)
     assign("f", f, envir = env)
     f &lt;- function(x) print(x)
     f(A)                                      # 2
     do.call("f", list(A))                     # 2
     do.call("f", list(A), envir = env)        # 4
     do.call( f,  list(A), envir = env)        # 2
     do.call("f", list(quote(A)), envir = env) # 100
     do.call( f,  list(quote(A)), envir = env) # 10
     do.call("f", list(as.name("A")), envir = env) # 100
     
     eval(call("f", A))                      # 2
     eval(call("f", quote(A)))               # 2
     eval(call("f", A), envir = env)         # 4
     eval(call("f", quote(A)), envir = env)  # 100</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>OK, so basically what happened is that</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">do.call</span>(rbind, list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Gets transformed into</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">rbind</span>(list[[<span class="dv">1</span>]], list[[<span class="dv">2</span>]], list[[<span class="dv">3</span>]], ..., list[[<span class="fu">length</span>(list)]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>That’s vectorization magic!</li>
</ul>
</div>
</section>
<section id="you-try-it-if-we-have-time" class="slide level2 smaller">
<h2>You try it! (if we have time)</h2>
<ul>
<li>Use the code you wrote before the get the incidence per 1000 people on the entire measles data set (add a column for incidence to the full data).</li>
<li>Use the code <code>plot(NULL, NULL, ...)</code> to make a blank plot. You will need to set the <code>xlim</code> and <code>ylim</code> arguments to sensible values, and specify the axis titles as “Year” and “Incidence per 1000 people”.</li>
<li>Using a <code>for</code> loop and the <code>lines()</code> function, make a plot that shows all of the incidence curves over time, overlapping on the plot.</li>
<li>HINT: use <code>col = adjustcolor(black, alpha.f = 0.25)</code> to make the curves partially transparent, so you can see the overlap.</li>
<li>BONUS PROBLEM: using the function <code>cumsum()</code>, make a plot of the cumulative cases (not standardized) over time for all of the countries. (Dealing with the NA’s here is tricky!!)</li>
</ul>
</section>
<section id="main-problem-hint" class="slide level2">
<h2>Main problem hint</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>meas<span class="sc">$</span>cases_per_thousand <span class="ot">&lt;-</span> meas<span class="sc">$</span>measles_cases <span class="sc">/</span> meas<span class="sc">$</span>population <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(meas<span class="sc">$</span>country)</span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="fu">plot</span>(</span>
<span id="cb49-5"><a href="#cb49-5"></a>    <span class="cn">NULL</span>, <span class="cn">NULL</span>,</span>
<span id="cb49-6"><a href="#cb49-6"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">2022</span>),</span>
<span id="cb49-7"><a href="#cb49-7"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb49-8"><a href="#cb49-8"></a>    <span class="at">xlab =</span> <span class="st">"Year"</span>,</span>
<span id="cb49-9"><a href="#cb49-9"></a>    <span class="at">ylab =</span> <span class="st">"Incidence per 1000 people"</span></span>
<span id="cb49-10"><a href="#cb49-10"></a>)</span>
<span id="cb49-11"><a href="#cb49-11"></a></span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="cf">for</span> (...) {</span>
<span id="cb49-13"><a href="#cb49-13"></a>    ...</span>
<span id="cb49-14"><a href="#cb49-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="main-problem-solution" class="slide level2">
<h2>Main problem solution</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>meas<span class="sc">$</span>cases_per_thousand <span class="ot">&lt;-</span> meas<span class="sc">$</span>measles_cases <span class="sc">/</span> meas<span class="sc">$</span>population <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(meas<span class="sc">$</span>country)</span>
<span id="cb50-3"><a href="#cb50-3"></a></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="fu">plot</span>(</span>
<span id="cb50-5"><a href="#cb50-5"></a>    <span class="cn">NULL</span>, <span class="cn">NULL</span>,</span>
<span id="cb50-6"><a href="#cb50-6"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">2022</span>),</span>
<span id="cb50-7"><a href="#cb50-7"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb50-8"><a href="#cb50-8"></a>    <span class="at">xlab =</span> <span class="st">"Year"</span>,</span>
<span id="cb50-9"><a href="#cb50-9"></a>    <span class="at">ylab =</span> <span class="st">"Incidence per 1000 people"</span></span>
<span id="cb50-10"><a href="#cb50-10"></a>)</span>
<span id="cb50-11"><a href="#cb50-11"></a></span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {</span>
<span id="cb50-13"><a href="#cb50-13"></a>    country_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(meas, country <span class="sc">==</span> countries[[i]])</span>
<span id="cb50-14"><a href="#cb50-14"></a>    <span class="fu">lines</span>(</span>
<span id="cb50-15"><a href="#cb50-15"></a>        <span class="at">x =</span> country_data<span class="sc">$</span>year,</span>
<span id="cb50-16"><a href="#cb50-16"></a>        <span class="at">y =</span> country_data<span class="sc">$</span>cases_per_thousand,</span>
<span id="cb50-17"><a href="#cb50-17"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> <span class="fl">0.25</span>)</span>
<span id="cb50-18"><a href="#cb50-18"></a>    )</span>
<span id="cb50-19"><a href="#cb50-19"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="main-problem-solution-1" class="slide level2">
<h2>Main problem solution</h2>

<img data-src="Module03-Iteration_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="bonus-problem-solution" class="slide level2">
<h2>Bonus problem solution</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># First calculate the cumulative cases, treating NA as zeroes</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>meas2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(meas, iso3c, year)</span>
<span id="cb51-3"><a href="#cb51-3"></a>meas2<span class="sc">$</span>cumulative_cases <span class="ot">&lt;-</span> <span class="fu">ave</span>(</span>
<span id="cb51-4"><a href="#cb51-4"></a>    <span class="at">x =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(meas2<span class="sc">$</span>measles_cases), <span class="dv">0</span>, meas2<span class="sc">$</span>measles_cases),</span>
<span id="cb51-5"><a href="#cb51-5"></a>    meas2<span class="sc">$</span>country,</span>
<span id="cb51-6"><a href="#cb51-6"></a>    <span class="at">FUN =</span> cumsum</span>
<span id="cb51-7"><a href="#cb51-7"></a>)</span>
<span id="cb51-8"><a href="#cb51-8"></a></span>
<span id="cb51-9"><a href="#cb51-9"></a><span class="fu">plot</span>(</span>
<span id="cb51-10"><a href="#cb51-10"></a>    <span class="cn">NULL</span>, <span class="cn">NULL</span>,</span>
<span id="cb51-11"><a href="#cb51-11"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">2022</span>),</span>
<span id="cb51-12"><a href="#cb51-12"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">7.3e6</span>),</span>
<span id="cb51-13"><a href="#cb51-13"></a>    <span class="at">xlab =</span> <span class="st">"Year"</span>,</span>
<span id="cb51-14"><a href="#cb51-14"></a>    <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">"Cumulative cases since"</span>, <span class="fu">min</span>(meas2<span class="sc">$</span>year))</span>
<span id="cb51-15"><a href="#cb51-15"></a>)</span>
<span id="cb51-16"><a href="#cb51-16"></a></span>
<span id="cb51-17"><a href="#cb51-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(countries)) {</span>
<span id="cb51-18"><a href="#cb51-18"></a>    country_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(meas2, country <span class="sc">==</span> countries[[i]])</span>
<span id="cb51-19"><a href="#cb51-19"></a>    <span class="fu">lines</span>(</span>
<span id="cb51-20"><a href="#cb51-20"></a>        <span class="at">x =</span> country_data<span class="sc">$</span>year,</span>
<span id="cb51-21"><a href="#cb51-21"></a>        <span class="at">y =</span> country_data<span class="sc">$</span>cumulative_cases,</span>
<span id="cb51-22"><a href="#cb51-22"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> <span class="fl">0.25</span>)</span>
<span id="cb51-23"><a href="#cb51-23"></a>    )</span>
<span id="cb51-24"><a href="#cb51-24"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bonus-problem-solution-1" class="slide level2">
<h2>Bonus problem solution</h2>

<!--
## More practice on your own {.smaller}

* Merge the `countries-regions.csv` data with the `measles_final.Rds` data.
Reshape the measles data so that `MCV1` and `MCV2` vaccine coverage are two
separate columns. Then use a loop to fit a poisson regression model for each
continent where `Cases` is the outcome, and `MCV1 coverage` and `MCV2 coverage`
are the predictors. Discuss your findings, and try adding an interation term.
* Assess the impact of `age_months` as a confounder in the Diphtheria serology
data. First, write code to transform `age_months` into age ranges for each
year. Then, using a loop, calculate the crude odds ratio for the effect of
vaccination on infection for each of the age ranges. How does the odds ratio
change as age increases? Can you formalize this analysis by fitting a logistic
regression model with `age_months` and vaccination as predictors?

-->

<img data-src="Module03-Iteration_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch"><div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>